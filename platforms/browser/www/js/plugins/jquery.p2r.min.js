+function (a, b) { "use strict"; var c = function (b, c) { this.$element = a(b), this.options = a.extend({}, self.DEFAULTS, c), this.$scroll = a(c.scroll), this.flags = { prevented: !1, moving: !1, touched: !1, isTouch: !1, refreshed: !1 }, this.positions = { startY: 0, startX: 0, lastStep: 0 } }; c.key = "pulltorefresh", c.DEFAULTS = { orientation: "down", sensibility: 5, refresh: 200, lockRefresh: !1, resetRefresh: !0, autoInit: !0, resetSpeed: "100ms", simulateTouch: !0, threshold: 20, scroll: b }, c.namespace = function (a) { return [a, c.key].join(".") }, c.support = { touch: window.Modernizr && Modernizr.touch === !0 || function () { return !!("ontouchstart" in window || window.DocumentTouch && b instanceof DocumentTouch) }() }, c.events = function () { if (c.support.touch) return { start: c.namespace("touchstart"), move: c.namespace("touchmove"), end: c.namespace("touchend") }; var a = { start: c.namespace("mousedown"), move: c.namespace("mousemove"), end: c.namespace("mouseup") }; return window.navigator.msPointerEnabled && (a = { start: c.namespace("MSPointerDown"), move: c.namespace("MSPointerMove"), end: c.namespace("MSPointerUp") }), window.navigator.pointerEnabled && (a = { start: c.namespace("pointerdown"), move: c.namespace("pointermove"), end: c.namespace("pointerup") }), a }(), c.prototype.construct = function () { var d = this; d.$element.on(c.events.start, d.proxy(d.onTouchStart, d)).on(c.events.move, d.proxy(d.onTouchMove, d)).on(c.events.end, d.proxy(d.onTouchEnd, d)), d.options.simulateTouch && (d.$element.on(c.namespace("mousedown"), d.proxy(d.onTouchStart, d)), a(b).on(c.namespace("mousemove"), d.$element, d.proxy(d.onTouchMove, d)).on(c.namespace("mouseup"), d.$element, d.proxy(d.onTouchEnd, d))) }, c.prototype.destroy = function () { this.remove_transition(this.$element[0].style), this.remove_transform(this.$element[0].style), a(b).off(c.namespace("")), this.$element.off(c.namespace("")), this.$element.removeData("pulltorefresh") }, c.prototype.proxy = function () { var b = !!Function.prototype.bind; return b ? function (a, b) { return a.bind(b) } : a.proxy ? a.proxy : function (a, b) { var c, d, e; return "string" == typeof b && (c = a[b], b = a, a = c), "function" == typeof a ? void 0 : (d = Array.prototype.slice.call(arguments, 2), e = function () { return a.apply(b || this, d.concat(slice.call(arguments))) }, e.guid = a.guid = a.guid || jQuery.guid++, e) } }(), c.prototype.transform = function (a, b) { a.webkitTransform = "translate(0, " + b + "px) " + "translateZ(0)", a.msTransform = a.MsTransform = a.MozTransform = a.OTransform = a.transform = "translateY(" + b + "px)" }, c.prototype.transition = function (a, b) { a.webkitTransitionDuration = a.MozTransitionDuration = a.msTransitionDuration = a.OTransitionDuration = a.transitionDuration = b }, c.prototype.remove_transition = function (a) { a.webkitTransitionDuration = a.MozTransitionDuration = a.msTransitionDuration = a.OTransitionDuration = a.transitionDuration = null }, c.prototype.remove_transform = function (a) { a.webkitTransform = a.msTransform = a.MsTransform = a.MozTransform = a.OTransform = a.transform = null }, c.prototype.getAxis = function (a, b) { return { x: b ? (a.targetTouches || a.originalEvent.targetTouches)[0].pageX : a.pageX || a.clientX, y: b ? (a.targetTouches || a.originalEvent.targetTouches)[0].pageY : a.pageY || a.clientY } }, c.prototype.onTouchStart = function (a) { var b = "touchstart" === a.type, d = this.getAxis(a, b); return this.$scroll.scrollTop() > 0 ? !0 : ((b || 1 === a.which) && (this.flags.touched = !0, this.flags.refreshed = !1, this.flags.isTouch = b, this.positions.startY = d.y, this.positions.startX = d.x, this.$element.trigger(c.namespace("start"), [d.y]), this.transition(this.$element[0].style, "0ms")), void 0) }, c.prototype.onTouchMove = function (b) { var e, f, g, h, d = "touchmove" === b.type; if (this.flags.touched && (!this.flags.isTouch || "mousemove" !== b.type)) { if (!this.flags.prevented && b.target && (b.target.click || b.target.onclick) && (a(b.target).off("click"), setTimeout(function () { a(b.target).on("click") }, 0), this.flags.prevented = !0), h = this.getAxis(b, d), e = h.y - this.positions.startY, Math.abs(h.x - this.positions.startX) > this.options.threshold) return this.reset(), void 0; if (!(0 > e && "down" == this.options.orientation || e >= 0 && "up" == this.options.orientation)) return (0 > e ? -1 * e : e) >= this.options.refresh && !this.flags.refreshed && (this.$element.trigger(c.namespace("refresh"), [h.y]), this.flags.refreshed = !0, this.options.resetRefresh) ? (this.reset(), void 0) : (this.flags.refreshed && this.options.lockRefresh || (f = parseInt(e / this.options.sensibility, 10), this.positions.lastStep != f && (g = parseInt(100 * e / this.options.refresh, 10), this.$element.trigger(c.namespace("move"), g), this.positions.lastStep = f), this.transform(this.$element[0].style, e), b.stopPropagation(), b.preventDefault()), void 0) } }, c.prototype.reset = function () { this.transition(this.$element[0].style, this.options.resetSpeed), this.transform(this.$element[0].style, 0), this.flags.touched = !1, this.flags.isTouch = !1, this.flags.refreshed = !1, this.positions.startY = !1 }, c.prototype.onTouchEnd = function (a) { this.flags.touched && (this.flags.prevented = !1, this.positions.startY = 0, this.positions.startX = 0, this.reset(), this.$element.trigger(c.namespace("end")), a.stopPropagation(), a.preventDefault()) }; var d = a.fn.pullToRefresh; a.fn.pullToRefresh = function (b) { return this.each(function () { var d = a(this), e = d.data(c.key), f = a.extend({}, c.DEFAULTS, d.data(), "object" == typeof b && b); return e || "destroy" != b ? (e || (d.data(c.key, e = new c(this, f)), f.autoInit && e.construct()), "string" == typeof b && e[b].apply(e), void 0) : c.destroy() }) }, a.fn.pullToRefresh.Constructor = c, a.fn.pullToRefresh.noConflict = function () { return a.fn.pullToRefresh = d, this } }(window.jQuery || window.Zepto, document);